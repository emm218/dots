#!/usr/bin/sh

shotpath="$HOME/pics/screenshots"
mkdir -p "$shotpath"

regions="selection\nfull screen"
dests="clipboard\nsave"

tmp="$(mktemp)"

case "$(echo "$regions" | dmenu $@)" in
	"selection")
		maim -osuf png > "$tmp"
		;;
	"full screen")
		maim -ouf png > "$tmp"
		;;
esac

case "$(echo "$dests" | dmenu $@)" in
	"clipboard")
		xclip -selection clipboard -t image/png < "$tmp"
		rm "$tmp"
		;;
	"save")
		dest="$(dmenu -p "filename" $@ < /dev/null)"
		mv "$tmp" "$shotpath/${dest:-$(date '+%Y%m%d%H%M%S')}.png"
		;;
esac

